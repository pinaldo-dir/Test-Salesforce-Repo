<?xml version="1.0" encoding="UTF-8"?>
<Flow xmlns="http://soap.sforce.com/2006/04/metadata">
    <actionCalls>
        <name>CM_Flow_Chatter</name>
        <label>CM Flow Chatter</label>
        <locationX>375</locationX>
        <locationY>464</locationY>
        <actionName>chatterPost</actionName>
        <actionType>chatterPost</actionType>
        <connector>
            <targetReference>Case_Status</targetReference>
        </connector>
        <inputParameters>
            <name>subjectNameOrId</name>
            <value>
                <elementReference>varCaseID</elementReference>
            </value>
        </inputParameters>
        <inputParameters>
            <name>text</name>
            <value>
                <elementReference>txtFlowStartDebug</elementReference>
            </value>
        </inputParameters>
        <nameSegment>chatterPost</nameSegment>
        <versionSegment>1</versionSegment>
    </actionCalls>
    <actionCalls>
        <name>status_New</name>
        <label>status New</label>
        <locationX>194</locationX>
        <locationY>556</locationY>
        <actionName>chatterPost</actionName>
        <actionType>chatterPost</actionType>
        <connector>
            <targetReference>New_Case</targetReference>
        </connector>
        <inputParameters>
            <name>subjectNameOrId</name>
            <value>
                <elementReference>varCaseID</elementReference>
            </value>
        </inputParameters>
        <inputParameters>
            <name>text</name>
            <value>
                <stringValue>Case Status New</stringValue>
            </value>
        </inputParameters>
        <nameSegment>chatterPost</nameSegment>
        <versionSegment>1</versionSegment>
    </actionCalls>
    <actionCalls>
        <name>status_New_0</name>
        <label>status Not New</label>
        <locationX>758</locationX>
        <locationY>473</locationY>
        <actionName>chatterPost</actionName>
        <actionType>chatterPost</actionType>
        <connector>
            <targetReference>What_Changed</targetReference>
        </connector>
        <inputParameters>
            <name>subjectNameOrId</name>
            <value>
                <elementReference>varCaseID</elementReference>
            </value>
        </inputParameters>
        <inputParameters>
            <name>text</name>
            <value>
                <stringValue>Case Status NOT New</stringValue>
            </value>
        </inputParameters>
        <nameSegment>chatterPost</nameSegment>
        <versionSegment>1</versionSegment>
    </actionCalls>
    <apiVersion>49.0</apiVersion>
    <assignments>
        <description>Used to pass variable values in to test the flow</description>
        <name>Input_Variables</name>
        <label>Input Variables</label>
        <locationX>552</locationX>
        <locationY>237</locationY>
        <assignmentItems>
            <assignToReference>varRecordTypeName</assignToReference>
            <operator>Assign</operator>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>boolIsNew</assignToReference>
            <operator>Assign</operator>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>varCaseStatus</assignToReference>
            <operator>Assign</operator>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>varEmployerID</assignToReference>
            <operator>Assign</operator>
        </assignmentItems>
        <connector>
            <targetReference>Valid_Inputs</targetReference>
        </connector>
    </assignments>
    <decisions>
        <name>Case_Rec_Type</name>
        <label>Case Rec Type</label>
        <locationX>926</locationX>
        <locationY>676</locationY>
        <defaultConnectorLabel>Other</defaultConnectorLabel>
        <rules>
            <name>BOFE</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>varRecordTypeName</leftValueReference>
                <operator>StartsWith</operator>
                <rightValue>
                    <stringValue>BOFE</stringValue>
                </rightValue>
            </conditions>
            <label>BOFE</label>
        </rules>
        <rules>
            <name>WCA_Garment</name>
            <conditionLogic>or</conditionLogic>
            <conditions>
                <leftValueReference>varRecordTypeName</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>WCA</stringValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>varRecordTypeName</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Garment</stringValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Office_Changed_Flow</targetReference>
            </connector>
            <label>WCA/Garment</label>
        </rules>
    </decisions>
    <decisions>
        <name>Case_Status</name>
        <label>Case Status</label>
        <locationX>553</locationX>
        <locationY>553</locationY>
        <defaultConnector>
            <targetReference>What_Changed</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Not New</defaultConnectorLabel>
        <rules>
            <name>New</name>
            <conditionLogic>( 1 OR 3 ) AND 2</conditionLogic>
            <conditions>
                <leftValueReference>varCaseStatus</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>New</stringValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>boolIsNew</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>varCaseStatus</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Open</stringValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>New_Case</targetReference>
            </connector>
            <label>New</label>
        </rules>
    </decisions>
    <decisions>
        <name>Valid_Inputs</name>
        <label>Valid Inputs</label>
        <locationX>552</locationX>
        <locationY>388</locationY>
        <defaultConnectorLabel>Invalid</defaultConnectorLabel>
        <rules>
            <name>Valid</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>varCaseID</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>varEmployerID</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>varRecordTypeName</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>varCaseStatus</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Case_Status</targetReference>
            </connector>
            <label>Valid</label>
        </rules>
    </decisions>
    <decisions>
        <description>Directs flow to appropriate subflow based on what changed</description>
        <name>What_Changed</name>
        <label>What Changed?</label>
        <locationX>723</locationX>
        <locationY>680</locationY>
        <defaultConnectorLabel>[Default Outcome]</defaultConnectorLabel>
        <rules>
            <name>Deputy_Set</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>boolDepChanged</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Perform_Assignment_Actions</targetReference>
            </connector>
            <label>Deputy</label>
        </rules>
        <rules>
            <name>Office</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>boolOfficeChanged</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Office_Changed_Flow</targetReference>
            </connector>
            <label>Office</label>
        </rules>
        <rules>
            <name>RecType</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>boolRecType</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Case_Rec_Type</targetReference>
            </connector>
            <label>RecType</label>
        </rules>
    </decisions>
    <description>Added office ID to choose case assignment based on the office of the case as well as the deputy assigned.</description>
    <interviewLabel>Case Management Flow {!$Flow.CurrentDateTime}</interviewLabel>
    <label>Case Management Flow</label>
    <processType>AutoLaunchedFlow</processType>
    <startElementReference>Valid_Inputs</startElementReference>
    <status>Active</status>
    <subflows>
        <name>New_Case</name>
        <label>New Case</label>
        <locationX>355</locationX>
        <locationY>677</locationY>
        <flowName>New_Case_Flow</flowName>
        <inputAssignments>
            <name>CaseID</name>
            <value>
                <elementReference>varCaseID</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <name>EmployerID</name>
            <value>
                <elementReference>varEmployerID</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <name>RecordTypeName</name>
            <value>
                <elementReference>varRecordTypeName</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <name>Status</name>
            <value>
                <elementReference>varCaseStatus</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <name>OfficeID</name>
            <value>
                <elementReference>varOfficeID</elementReference>
            </value>
        </inputAssignments>
    </subflows>
    <subflows>
        <name>Office_Changed_Flow</name>
        <label>Office Changed Flow</label>
        <locationX>927</locationX>
        <locationY>833</locationY>
        <flowName>Case_Office_Changed_Flow</flowName>
        <inputAssignments>
            <name>varCaseID</name>
            <value>
                <elementReference>varCaseID</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <name>varCaseRecType</name>
            <value>
                <elementReference>varRecordTypeName</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <name>varOfficeID</name>
            <value>
                <elementReference>varOfficeID</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <name>varPriorOfficeName</name>
            <value>
                <elementReference>varPriorOfficeName</elementReference>
            </value>
        </inputAssignments>
    </subflows>
    <subflows>
        <name>Perform_Assignment_Actions</name>
        <label>Perform Assignment Actions</label>
        <locationX>925</locationX>
        <locationY>526</locationY>
        <flowName>CM_Peform_Assignment_Actions</flowName>
        <inputAssignments>
            <name>CaseID</name>
            <value>
                <elementReference>varCaseID</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <name>CaseRTID</name>
            <value>
                <elementReference>varRecordTypeName</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <name>AssignedDeputyID</name>
            <value>
                <elementReference>varDepId</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <name>AssignedDeputyUserID</name>
            <value>
                <elementReference>varAssignedDeputyUserID</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <name>AssignedDeputyEmail</name>
            <value>
                <elementReference>varAssignedDeputyEmail</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <name>SeniorDeputyID</name>
            <value>
                <elementReference>varSeniorDeputyID</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <name>SeniorDeputyUserID</name>
            <value>
                <elementReference>varSeniorDeputyUserID</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <name>SeniorDeputyEmail</name>
            <value>
                <elementReference>varSeniorDeputyEmail</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <name>DirOfficeId</name>
            <value>
                <elementReference>varOfficeID</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <name>Status</name>
            <value>
                <elementReference>varCaseStatus</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <name>L_RCase</name>
            <value>
                <elementReference>varL_RCase</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <name>IntialAssignmentDate</name>
            <value>
                <elementReference>varIntialassignmentDate</elementReference>
            </value>
        </inputAssignments>
    </subflows>
    <textTemplates>
        <name>CaseManagementDebug</name>
        <isViewedAsPlainText>false</isViewedAsPlainText>
        <text>Case Management Flow started

boolDepChanged = {!boolDepChanged}
boolDepSet = {!boolDepSet}</text>
    </textTemplates>
    <textTemplates>
        <description>displays variables when the flow starts in chatter</description>
        <name>txtFlowStartDebug</name>
        <isViewedAsPlainText>false</isViewedAsPlainText>
        <text>Case managment flow started:

Case Status: {!varCaseStatus}
Rec Type: {!varRecordTypeName}
Is New flag: {!boolIsNew}</text>
    </textTemplates>
    <variables>
        <description>Boolean set by PB indicating whether the deputy has changed on the case</description>
        <name>boolDepChanged</name>
        <dataType>Boolean</dataType>
        <isCollection>false</isCollection>
        <isInput>true</isInput>
        <isOutput>false</isOutput>
        <value>
            <booleanValue>false</booleanValue>
        </value>
    </variables>
    <variables>
        <description>boolean flag set by process builder when the deputy is set, unset, or changed</description>
        <name>boolDepSet</name>
        <dataType>Boolean</dataType>
        <isCollection>false</isCollection>
        <isInput>true</isInput>
        <isOutput>false</isOutput>
        <value>
            <booleanValue>false</booleanValue>
        </value>
    </variables>
    <variables>
        <description>flag set from process builder by comparing the create date and the last modified date and passing true or false to this variable in the flow</description>
        <name>boolIsNew</name>
        <dataType>Boolean</dataType>
        <isCollection>false</isCollection>
        <isInput>true</isInput>
        <isOutput>true</isOutput>
        <value>
            <booleanValue>false</booleanValue>
        </value>
    </variables>
    <variables>
        <description>flag set by process builder when the office is changed</description>
        <name>boolOfficeChanged</name>
        <dataType>Boolean</dataType>
        <isCollection>false</isCollection>
        <isInput>true</isInput>
        <isOutput>false</isOutput>
        <value>
            <booleanValue>false</booleanValue>
        </value>
    </variables>
    <variables>
        <description>boolean flag set by process builder when rec type chages</description>
        <name>boolRecType</name>
        <dataType>Boolean</dataType>
        <isCollection>false</isCollection>
        <isInput>true</isInput>
        <isOutput>false</isOutput>
        <value>
            <booleanValue>false</booleanValue>
        </value>
    </variables>
    <variables>
        <description>Email address of the deputy assigned to case passed from process builder</description>
        <name>varAssignedDeputyEmail</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>true</isInput>
        <isOutput>true</isOutput>
    </variables>
    <variables>
        <description>User ID of the assigned deputy passed from process builder</description>
        <name>varAssignedDeputyUserID</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>true</isInput>
        <isOutput>true</isOutput>
    </variables>
    <variables>
        <description>ID of the case passed from the process builder</description>
        <name>varCaseID</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>true</isInput>
        <isOutput>true</isOutput>
    </variables>
    <variables>
        <description>Status of the case that started the flow</description>
        <name>varCaseStatus</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>true</isInput>
        <isOutput>true</isOutput>
    </variables>
    <variables>
        <description>Assigned Deputy ID passed from process builder</description>
        <name>varDepId</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>true</isInput>
        <isOutput>true</isOutput>
    </variables>
    <variables>
        <description>Employer ID passed from the Process builder</description>
        <name>varEmployerID</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>true</isInput>
        <isOutput>true</isOutput>
    </variables>
    <variables>
        <name>varIntialassignmentDate</name>
        <dataType>Date</dataType>
        <isCollection>false</isCollection>
        <isInput>true</isInput>
        <isOutput>true</isOutput>
    </variables>
    <variables>
        <description>flag sent from pb indicating that the case includes an inspection request</description>
        <name>varL_RCase</name>
        <dataType>Boolean</dataType>
        <isCollection>false</isCollection>
        <isInput>true</isInput>
        <isOutput>true</isOutput>
        <value>
            <booleanValue>false</booleanValue>
        </value>
    </variables>
    <variables>
        <description>ID of the office of the case passed by PB</description>
        <name>varOfficeID</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>true</isInput>
        <isOutput>true</isOutput>
    </variables>
    <variables>
        <description>Name of office&apos;s prior value passed from PB</description>
        <name>varPriorOfficeName</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>true</isInput>
        <isOutput>true</isOutput>
    </variables>
    <variables>
        <description>RT of the case before it was changed. passed from pb</description>
        <name>varPriorRecType</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>true</isInput>
        <isOutput>true</isOutput>
    </variables>
    <variables>
        <description>Rec Type developer name of the case that triggered the flow</description>
        <name>varRecordTypeName</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>true</isInput>
        <isOutput>true</isOutput>
    </variables>
    <variables>
        <description>Email address of the senior deputy assigned to the case passed by process builder</description>
        <name>varSeniorDeputyEmail</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>true</isInput>
        <isOutput>true</isOutput>
    </variables>
    <variables>
        <description>ID of the senior deputy assigned to the case passed from process builder</description>
        <name>varSeniorDeputyID</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>true</isInput>
        <isOutput>true</isOutput>
    </variables>
    <variables>
        <description>user ID of the senior deputy assigned to the case passed from process builder</description>
        <name>varSeniorDeputyUserID</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>true</isInput>
        <isOutput>true</isOutput>
    </variables>
</Flow>
